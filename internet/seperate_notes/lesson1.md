# 第一章 计算机网络的概念

## 计算机网络的概念 组成 功能 分类

### 概念

计算机网络： 是一个将分散的，具有独立功能的计算机系统，通过通信设备与线路连接起来，由功能完善的软件实现资源共享和信息传递的系统。是一个互联的，自治的计算机集合。

### 功能

1. 数据通信（连通性）

2. 资源共享（硬件，软件，数据）

3. 分布式处理：多台计算机各自承担同一工作任务的不同部分

4. 提高可靠性：替代机

5. 负载均衡

### 组成

组成部分：硬件，软件，协议

工作方式：

1. 边缘部分： 用户直接使用，C/S 方式，P2P方式。 

2. 核心部分：为边缘部分服务。

功能组成：数据通信，资源共享。

1. 通信子网：网络层，数据链路层，物理层，实现数据通信。

2. 资源子网：应用层，表示层，会话层，实现资源共享/数据处理。

![计算机网络的功能组成](https://github.com/nilshao/cpp-notebook/raw/master/internet/pictures/chapter01/计算机网络的功能组成.jpeg)

### 分类

+ 按分布范围分：广域网WAN，城域网MAN，局域网WAN，个人区域网PAN。

  局域网：广播技术，广域网：交换技术

+ 按使用者分：公用网，专用网

+ 按交换技术分：电路交换，报文交换，分组交换。

+ 按拓扑结构分：总线型，星型，环形，网状型。

+ 按传输技术分：广播式网络：共享公共通信信道。点对点网络：使用分组存储转发和路由选择机制。

## 标准化工作

标准的分类：

法定标准：由权威机构制定的正式的，合法的标准 OSI

事实标准：某些公司的产品在竞争中占据了主流，时间长了这些产品中的协议和技术就成了标准。

### 标准化工作的相关组织

ISO,ITU,IEEE,IETF

## 性能指标

速度，带宽，吞吐量，时延，时延带宽积，往返时间RTT，利用率

### 速率

数据率或称数据传输率或比特率。

**比特bit：** 1/0 单位是位。 1Byte=8bit

速率：连接在计算机网络上的主机在数字信道上传输数据位数的速率。（发送端，接收端）

单位：b/s，kb/s，Mb/s，Gb/s，Tb/s

### 带宽

1. 带宽原本指某个信号具有的**频带宽度**，即最高频率与最低频率之差，单位Hz（模拟信号）

2. 计算机网络中，带宽用来表示网络的通信线路传送数据能力，通常是单位时间内从网络中的某一点到另一点所能通过的最高数据率。单位是比特每秒。
**“网络设备所支持的最高速度”**

链路：链路带宽=1Mb/s，主机在1us内可项链路发1bit数据，传播速率：电磁波1us可传播200m，2*10 8次方m/s

### 吞吐量

单位时间内通过某个网络（或信道，接口）的数据量，单位b/s，kb/s，Mb/s等。

吞吐量受网络的带宽或网络的额定速率限制。

### 时延：

指数据（报文，分组，比特流）从网络（或链路）的一端传送到另一端所需的时间，也叫延迟或迟延，单位是s

时延分为：发送时延（传输时延），传播时延，排队时延，处理时延

1. 发送时延：从发送分组的第一个比特算起，到该分组的最后一个比特发送完毕所需要的时间。

  >**发送时延=数据长度/信道带宽（发送速率）**

2. 传播时延：取决于电磁波传播速度和链路长度。
  >**传播时延=信道长度/电磁波在信道上的传播速率**

3. 排队时延：等待输入/输出链路可用。

4. 处理时延：捡错、找出口

### 时延带宽积

>时延带宽积（bit） = 传播时延（s）* 带宽（b/s）

带宽指的是发送端发送时可以达到的最大数据率，电磁波在信道上传播一定距离所花费的时间。描述信息量/数据量多少。又被称为一比特位单位的链路长度，即某段链路现在有多少比特（容量）

### 往返时延RTT

从发送方发送数据开始，到发送方收到接收方的确认（接收方收到数据后立即发送确认），总共经历的时延。
RTT越大，在**收到确认之前**可以发送的数据越多。

>RTT包括：往返传播时延 = 传播时延*2，以及末端处理时间，一般忽略传播时延。

### 利用率

>信道利用率 = 有数据通过时间 /（有+无）数据通过时间

网络利用率：信道利用率加权平均值

## 分层结构

### 为什么要分层

发送文件前要解决很多工作，比如：

1. 发起通信的计算机必须将数据通信的通路进行激活。

2. 高速网络如何识别目的主机。

3. 发起通信的计算机要查明目的主机是否开机，并且与网络连接正常。

4. 发起通信的计算机要查明对方计算机中文件管理程序是否做好准备工作。

5. 确保差错和意外可以解决。

### 如何分层

（对等）实体之间的协议，接口，服务

基本原则：

1. 各层之间相互独立，每层只实现一种相对独立的功能

2. 每层之间界面自然清晰，易于理解，相互交流尽量少

3. 结构上可以分割开，每层采用最合适的技术来实现。

4. 保持下层对上层的独立性，上层单向使用下层提供的服务。

5. 整个分层结构应该能促进标准化工作

### 分层结构：


![分层结构1](https://github.com/nilshao/cpp-notebook/raw/master/internet/pictures/chapter01/分层结构1.jpeg)

1. 实体：第n层中的活动元素称为n层实体，同一层实体叫做对等实体

2. 协议：为进行网络中的**对等实体**数据交换而建立的规则，标准或约定称为网络协议。
要规定语法，语义（要完成的功能），同步（规定各种操作的顺序）

3. 接口：访问服务点SAP：上层使用下层服务，下层为上层提供服务的入口

4. 服务：**下层为相邻上层**提供的功能调用（垂直）。

    SDU 服务数据单元：为完成用户所要求的功能而应传送的数据。

    PCI 协议控制信息：控制协议操作的信息。

    PDU 协议数据单元：对等层次之间传送的数据单位。

![分层结构2](https://github.com/nilshao/cpp-notebook/raw/master/internet/pictures/chapter01/分层结构2.jpeg)

### 概念总结

+ 网络体系结构是从功能上描述计算机网络结构

+ 计算机网络体系结构分层结构

+ 每层遵循某个/某些网络协议以完成本层功能

+ 计算机网络体系结构是计算机网络的各层机器协议的集合。

+ 第n层在向n+1层提供服务时，此服务不仅包含第n层本身的功能，还包含由下层服务提供的功能。

+ 仅仅在相邻层间有接口，且所提供服务的具体实现细节对上一层完全屏蔽。

+ 体系结构是抽象的，而实现是指能运行的一些软件和硬件

## OSI参考模型

+ 7层OSI参考模型（法定模型）

+ 4层TCP/IP参考模型（事实标准）

+ 5层体系结构

### ISO/OSI参考模型的由来

按功能分层结构

目的：支持异构网络系统的互联互通。1984：OSI参考模型。

### 七层参考模型

物理层，数据链路层，网络层，传输层，会话层，表示层，应用层

OSI模型层之间有很多重复功能

通信子网（数据通信）：1，2，3 。 资源子网（数据处理）：5，6，7

### 用OSI参考模型解释通信过程

![osi参考模型解释通信过程](https://github.com/nilshao/cpp-notebook/raw/master/internet/pictures/chapter01/osi参考模型解释通信过程.PNG)

![osi参考模型解释通信过程2](https://github.com/nilshao/cpp-notebook/raw/master/internet/pictures/chapter01/osi参考模型解释通信过程2.PNG)

### **应用层**

所有能和**用户**交互产生网络流量的程序。

典型应用层服务：文件传输（FTP），电子邮件（SMTP），万维网（HTTP）

&nbsp;

### **表示层**

用于处理在两个通信系统中交换信息的表示方式（语法和语义）

+ 功能一：数据格式变换

+ 功能二：数据加密和解密

+ 功能三：数据压缩和恢复

&nbsp;

### **会话层**

向表示层实体/用户进程提供建立连接并在连接上有序地传输数据。这是会话，也是建立同步（SYN）

+ 功能一：建立，管理，终止对话

+ 功能二：使用校验点可使会话在通信失效时从校验点/同步点继续恢复通信，实现数据同步（适用于传输大文件）

&nbsp;

### **传输层**

负责主机中两个进程的通信，即端到端的通信。传输单位是报文段或用户数据报。

+ 功能一：可靠传输，不可靠传输

+ 功能二：差错控制

+ 功能三：流量控制：发送和接收的速度匹配

+ 功能四：复用分用

  复用：多个应用层进程可同时使用下面运输层的服务。

  分用：运输层把收到的信息分别交付给上面应用层中**相应**的进程。

协议：UDP，TCP

&nbsp;


### **网络层（IP层，网际层）**

主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务。
网络层传输单位是数据报。

+ 功能一：路由选择（最佳路径）

+ 功能二：流量控制

+ 功能三：差错控制

+ 功能四：拥塞控制

  若所有节点都来不及接受分组，而要丢弃大量分组的话，网络就处于拥塞状态。因此要采取一定措施缓解这种拥塞

主要协议：IP, IPX, ICMP, IGMP, ARP, RARP, OSPF

&nbsp;

### **数据链路层（链路层）**


主要是把网络层传下来的数据报组装成帧。数据链路层/链路层的传输单位是帧。

主要协议：SDLC, HDLC, PPP, STP

+ 功能一：组装成帧：定义帧的开始和结束

+ 功能二：差错控制：帧错+位错

+ 功能三：流量控制

+ 功能四：访问（接入）控制：控制对信道的访问

&nbsp;

### **物理层**

在物理媒体上实现比特流的透明传输。
物理层传输单位是比特。

透明传输：指不管所传输数据是什么样的比特组合，都应当能够在链路上传送。

+ 功能一：定义接口特性。

+ 功能二：定义传输模式：单工，双工，半双工。

  单工：单方向，发送端接收端只能有一个在发送，发送端和接收端被确定。

  半双工：两者都可作为发送端或接收端，但同时只能有一个在发送。

+ 功能三：定义传输速率

+ 功能四：比特同步

+ 功能五：比特编码

  协议：Rj45，802.3

&nbsp;

## TCP/IP模型and五层参考模型

先有协议栈，再根据协议栈形成了分层

### TCP/IP模型

![osi与tcpip模型](https://github.com/nilshao/cpp-notebook/raw/master/internet/pictures/chapter01/osi与tcpip模型.JPG)

相同点：

1. 都分层

2. 基于独立协议栈的概念

3. 实现**异构网络互联**

不同点：

1. OSI定义三点：服务，协议，接口

2. OSI先出现，参考模型先于协议发明，不偏向特定协议。

3. TCP/IP设计之初就考虑到异构网互联问题，将IP作为重要层次

4. 表格


    | | ISO/OSI参考模型 | TCP/IP模型 |
    | ---- | ---- | ---- |
    | 网络层 | 无连接+ 面向连接| 无连接 |
    | 传输层 | 面向连接 | 无连接+面向连接 |
&nbsp;

**面向连接**分为三个阶段，第一个是建立连接，在此阶段，发出一个建立连接的请求。第二阶段：只有在连接成功建立之后才能开始数据传输。第三阶段：当数据传输完毕释放连接，实现“可靠传输”，而**无连接**没有这么多阶段，直接进行数据传输。

&nbsp;
### 五层参考模型

应用层：支持各种网络应用，FTP, SMTP, HTTP

传输层：进程-进程之间的数据传输 TCP，UDP

网络层：源主机到目的主机的数据分组路由与转发 IP,ICMP,OSPF等

数据链路层：把网络层传下来的数据报组装成帧 Ethernet，PPP

物理层：比特传输

&nbsp;

### 五层参考模型的数据封装与解封装

![五层参考模型的数据封装与解封装](https://github.com/nilshao/cpp-notebook/raw/master/internet/pictures/chapter01/五层参考模型的数据封装与解封装.jpeg)